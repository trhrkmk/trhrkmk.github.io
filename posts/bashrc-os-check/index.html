<!DOCTYPE html>
<html>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="generator" content="Hugo 0.83.1" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reseter.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@exampledev/new.css@1.1.3/new.min.css">
  <link rel="stylesheet" href="https://www.trhrkmk.comcss/syntax.css">
  <link rel="stylesheet" href="https://www.trhrkmk.comcss/custom.css">
  <title>.bashrcでOSを確認する | trhrkmk.com</title>
  <link rel="canonical" href="https://www.trhrkmk.com/posts/bashrc-os-check/">

  <meta name="description" content="  " />
  <body>
    <div id="wrapper"><header>
  <div class="head__inner">
    <h1><a href="https://www.trhrkmk.com">trhrkmk.com</a></h1>
  </div>
</header>
<div id="content">
<main>
  <section class="entry">
    <h2>.bashrcでOSを確認する</h2>
    <p>最近、<code>.bashrc</code>や<code>.vimrc</code>など、見直してました。</p>
<p>macOSで利用している<code>.bashrc</code>を、Linuxでも利用したいと思ったからです。</p>
<p>ということで、自分用のメモ。</p>
<h2 id="bashrc">.bashrc</h2>
<p><code>.bashrc</code>は、シンプルに外部ファイルを読み込むだけにしました。</p>
<p>gitリポジトリは、<code>ghq</code>で管理しているので、こんな感じ。</p>
<pre><code>. $HOME/go/src/gitlab.com/teruhirokomaki/dotfiles/.bash_bashrc.bash
. $HOME/go/src/gitlab.com/teruhirokomaki/dotfiles/.bash_alias.bash
. $HOME/go/src/gitlab.com/teruhirokomaki/dotfiles/.bash_function.bash
</code></pre><h2 id="bash_bashrcbash">.bash_bashrc.bash</h2>
<p>ファイルの一部を切り取っています。</p>
<p>こんな感じで記述しました。</p>
<pre><code>#--------------------------------------------------
# os
#--------------------------------------------------
if [ &quot;`uname`&quot; == &quot;Darwin&quot; ]; then
  ISMAC=true
elif [ &quot;`uname`&quot; == &quot;Linux&quot; ]; then
  ISLINUX=true
fi

#--------------------------------------------------
# fzf
#--------------------------------------------------

if [ $ISLINUX ]; then
  [ -f ~/.fzf.bash ] &amp;&amp; source ~/.fzf.bash
fi
</code></pre><h2 id="ファイル名についての模索">ファイル名についての模索</h2>
<p>ファイル名の規則ってどんな感じなんでしょうかね？</p>
<p>gcpのsdkをインストールした際に<code>.bash_profile</code>に追記されたのが、こちら</p>
<p><code>path.bash.inc</code>と<code>completion.bash.inc</code>というファイル名なんですね。</p>
<p>先程の外部ファイルは<code>.bash_bashrc.bash</code>としてますが<code>bashrc.bash.inc</code>にしても良いかもしれない。</p>
<pre><code># The next line updates PATH for the Google Cloud SDK.
if [ -f '/Users/teruhirokomaki/google-cloud-sdk/path.bash.inc' ]; then source '/Users/teruhirokomaki/google-cloud-sdk/path.bash.inc'; fi

# The next line enables shell command completion for gcloud.
if [ -f '/Users/teruhirokomaki/google-cloud-sdk/completion.bash.inc' ]; then source '/Users/teruhirokomaki/google-cloud-sdk/completion.bash.inc'; fi
</code></pre><h2 id="ググってみた">ググってみた</h2>
<p>ググってみると…</p>
<p><a href="https://stackoverflow.com/questions/394230/how-to-detect-the-os-from-a-bash-script">How to detect the OS from a Bash script?</a></p>
<p><code>uname</code>と<code>$OSTYPE</code>のパターンがありましたが、macOSの場合の記述がシンプルなので、<code>uname</code>にしました。</p>
<h3 id="uname">uname</h3>
<pre><code>platform='unknown'
unamestr=`uname`
if [[ &quot;$unamestr&quot; == 'Linux' ]]; then
   platform='linux'
elif [[ &quot;$unamestr&quot; == 'FreeBSD' ]]; then
   platform='freebsd'
fi
</code></pre><h3 id="ostype">$OSTYPE</h3>
<pre><code>if [[ &quot;$OSTYPE&quot; == &quot;linux-gnu&quot; ]]; then
        # ...
elif [[ &quot;$OSTYPE&quot; == &quot;darwin&quot;* ]]; then
        # Mac OSX
elif [[ &quot;$OSTYPE&quot; == &quot;cygwin&quot; ]]; then
        # POSIX compatibility layer and Linux environment emulation for Windows
elif [[ &quot;$OSTYPE&quot; == &quot;msys&quot; ]]; then
        # Lightweight shell and GNU utilities compiled for Windows (part of MinGW)
elif [[ &quot;$OSTYPE&quot; == &quot;win32&quot; ]]; then
        # I'm not sure this can happen.
elif [[ &quot;$OSTYPE&quot; == &quot;freebsd&quot;* ]]; then
        # ...
else
        # Unknown.
fi
</code></pre><pre><code>case &quot;$OSTYPE&quot; in
  solaris*) echo &quot;SOLARIS&quot; ;;
  darwin*)  echo &quot;OSX&quot; ;;
  linux*)   echo &quot;LINUX&quot; ;;
  bsd*)     echo &quot;BSD&quot; ;;
  msys*)    echo &quot;WINDOWS&quot; ;;
  *)        echo &quot;unknown: $OSTYPE&quot; ;;
esac
</code></pre><h2 id="参考にしました">参考にしました</h2>
<ul>
<li><a href="https://stackoverflow.com/questions/394230/how-to-detect-the-os-from-a-bash-script">How to detect the OS from a Bash script?</a></li>
<li><a href="https://qiita.com/UmedaTakefumi/items/fe02d17264de6c78443d">シェルスクリプトでOSを判別する</a></li>
</ul>

  </section>
</main>

      </div><footer>
  <div class="foot__inner">
    <p class="copyright">Copyright © 2019-2021 Teruhiro Komaki <a href="https://twitter.com/trhrkmk">@trhrkmk</a></p>
  </div>
</footer>
</div>
  </body>
</html>
